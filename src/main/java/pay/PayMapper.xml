<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="pay.PayMapper">
	<select id="getNextPaymentId" resultType="int">
	    SELECT payment_id_seq.NEXTVAL FROM dual
	</select>


<!-- 결제 및 주문상품을 각각 행으로 저장 -->
  <insert id="insertPayment" parameterType="map">
    INSERT INTO payments (
      payment_id, u_id, name, num, address, post, detail_address
    )
    VALUES (
      #{paymentId, jdbcType=INTEGER}, 
      #{userId, jdbcType=VARCHAR}, 
      #{name, jdbcType=VARCHAR}, 
      #{num, jdbcType=VARCHAR}, 
      #{address, jdbcType=VARCHAR}, 
      #{post, jdbcType=VARCHAR}, 
      #{detailAddress, jdbcType=VARCHAR}
    )
  </insert>

  <insert id="insertPaymentItem" parameterType="map">
    INSERT INTO payment_items (
      payment_item_id, payment_id, title, quantity, price
    ) VALUES (
      payment_item_id_seq.nextval, 
      #{paymentId, jdbcType=INTEGER}, 
      #{item.title, jdbcType=VARCHAR}, 
      #{item.quantity, jdbcType=INTEGER}, 
      #{item.price, jdbcType=INTEGER}
    )
  </insert>
</mapper>
